# Linear Workflow for Claude Code

**IMPORTANT:** This document defines the required workflow when Claude Code works with Linear issues. This workflow MUST be followed for all Linear issue-based development.

## Overview

This project uses Linear for issue tracking with MCP (Model Context Protocol) integration. This enables Claude Code to read, create, update, and comment on Linear issues directly.

## MCP Server Configuration

This project is configured to use the Linear MCP server for seamless integration with Linear issues.

### For Claude Code (CLI)

**Setup is already complete for this project!** The Linear MCP server was configured during installation.

If you need to set up MCP on a different machine or project:

1. Add the Linear MCP server:
   ```bash
   claude mcp add --transport http linear-server https://mcp.linear.app/mcp
   ```

2. Authenticate with Linear:
   - Type `/mcp` in Claude Code
   - Complete OAuth authentication in your browser
   - Grant access to your Linear workspace

**Troubleshooting:**
- If MCP tools aren't available, verify the server was added: `cat ~/.claude.json`
- Clear cached auth if needed: `rm -rf ~/.mcp-auth`
- Restart Claude Code after adding the MCP server

### For Claude Desktop (Team Members)

If team members are using Claude Desktop (not Claude Code CLI), they should:

1. Add to their global config file at:
   `~/Library/Application Support/Claude/claude_desktop_config.json`

   ```json
   {
     "mcpServers": {
       "linear": {
         "command": "npx",
         "args": ["-y", "mcp-remote", "https://mcp.linear.app/mcp"]
       }
     }
   }
   ```

2. Restart Claude Desktop application

3. Authenticate via OAuth when prompted

**Reference files in this project:**
- `.mcp.json` - Example config for Claude Desktop users
- `.env.example` - Reference template (not used for MCP setup)

---

## Team Configuration

- **Team:** {{linear.teamName}} ({{linear.teamKey}})
- **Workspace:** {{linear.workspaceName}}
- **Issue Pattern:** {{formats.issuePattern}} (e.g., {{formats.issueExample}})

---

## Branch Strategy

- **Primary Branch:** `{{branches.main}}`{{#branches.staging}}
- **Staging Branch:** `{{branches.staging}}`{{/branches.staging}}{{#branches.prod}}
- **Production Branch:** `{{branches.prod}}`{{/branches.prod}}

---

## Status Transitions

| Event | Linear Status |
|-------|---------------|
| Push to feature branch | {{linear.statuses.inProgress}} |{{#branches.staging}}
| PR merged to {{branches.staging}} | {{linear.statuses.staging}} |{{/branches.staging}}
| PR merged to {{branches.main}} | {{linear.statuses.review}} |{{#branches.prod}}
| PR merged to {{branches.prod}} | {{linear.statuses.done}} |{{/branches.prod}}

---

## Required Workflow

### When Creating a Branch from a Linear Issue

**IMPORTANT:** When starting work on a Linear issue, you MUST follow these steps:

#### 1. Update Local Repository

**ALWAYS start by ensuring you're on the latest {{branches.main}} branch:**

```bash
git checkout {{branches.main}}
git pull origin {{branches.main}}
```

**Why:** Ensures you analyze the issue against the current codebase state, avoiding conflicts and outdated context.

#### 2. Fetch Complete Context

Use `get_issue` and `list_comments` to gather:

- Parent issues, blockers, related issues
- Tags, labels, priority level
- All comments and existing context
- Attachments, screenshots, recordings

#### 3. Reformat Issue for Analysis

**IMPORTANT:** Before diving into technical investigation, reformat the raw Linear issue into a structured analysis format.

**Use this 11-section format:**

```markdown
## 1. Title
**[Clear, specific, actionable title]**

## 2. Description

### Problem Statement
[What is the core issue or need?]

### Current Behavior
[What happens now? Be specific with examples]

### Expected Behavior
[What should happen instead? Clear success criteria]

## 3. Acceptance Criteria
- [ ] Criterion 1
- [ ] Criterion 2
- [ ] Criterion 3

## 4. Labels/Tags
- [Label 1]
- [Label 2]

## 5. Priority
**[Priority Level]** - [Impact assessment]

## 6. Screenshots/Attachments
[Links to visual evidence, recordings, or examples]

## 7. Related Issues
- **Parent Issue:** [ID and description]
- **Blockers:** [Any blocking issues]
- **Related:** [Similar or dependent issues]
- **Feature Area:** [Code location]

## 8. Technical Context

### Likely Root Cause
[Hypothesis about what's causing the issue]

### Key Files to Investigate
- [File path 1] - [Purpose]
- [File path 2] - [Purpose]

### Expected Data Structure
[Code examples showing current vs expected state]

## 9. User Stories

**As a** [user role]
**I want** [goal]
**So that** [benefit]

**Scenario:**
[Step-by-step user journey]

## 10. Environment Details
- **Platform:** [CBE/FFE/API]
- **Feature:** [Feature name]
- **Browser:** [If applicable]
- **Environment:** [Dev/Staging/Production]

### Steps to Reproduce
1. [Step 1]
2. [Step 2]
3. **BUG:** [What happens]

## 11. Original Issue

**Issue ID:** [{{formats.issueExample}}]
**Created:** [Date]
**Created By:** [Name]
**Assigned To:** [Name]
**Status:** [Status]
**Team:** [Team]

**Original Description:**
> [Raw description from Linear]

**Linear URL:** [URL]
```

**Where to store this:**
- Create subfolder: `{{paths.issues}}{{formats.issueExample}}-brief-description/`
- File location: `{{paths.issues}}{{formats.issueExample}}-brief-description/task-analysis.md`
- Add reformatted issue as the **first section** of the task analysis document

#### 4. Post Task Analysis

**IMPORTANT:** Task analysis has two components:

**A. Detailed Investigation** - Write comprehensive analysis to `{{paths.issues}}{{formats.issueExample}}-brief-description/task-analysis.md`:

- **Section 1:** Reformatted issue (11-section format from Step 3)
- **Section 2:** Deep technical analysis
  - Full codebase analysis with code snippets
  - Technical implementation details
  - Multiple solution approaches evaluated
  - Potential edge cases and testing strategy

**B. Linear Comment** - Post concise summary to Linear issue using `create_comment`:

```markdown
## Task Analysis Complete

**Type:** [Feature / Bug / Improvement / etc.]

**Problem:** [Brief 1-2 sentence description of the issue]

**Scope:**

- [Key item 1]
- [Key item 2]
- [Key item 3]

**Approach:**

- [High-level step 1]
- [High-level step 2]
- [High-level step 3]

**Status:** [Status indicator - see below]

**Detailed Analysis:** `{{paths.issues}}{{formats.issueExample}}-brief-description/task-analysis.md`

---

**Questions/Blockers:** [Any questions needing human input, or "None"]
```

**Status Indicators:**

- ğŸŸ¢ **Ready to implement** - Analysis complete, no blockers
- ğŸŸ  **Awaiting feedback** - Questions need answers before proceeding
- ğŸŸ  **In progress** - Currently implementing
- ğŸ”´ **Blocked** - Cannot proceed due to dependencies or critical issues

#### 5. Create Feature Branch

Follow naming convention: `feature/{{formats.issueExample}}-brief-description`

```bash
git checkout -b feature/{{formats.issueExample}}-brief-description
```

#### 6. Create Initial Commit

Commit task analysis reference:

```bash
git commit --allow-empty -m "chore: Initialize {{formats.issueExample}} with task analysis

Task Analysis posted to Linear issue.
See: [Linear issue URL]

Related: {{formats.issueExample}}"
```

**Why:** Creates traceable link between code work and Linear analysis.

#### 7. Push Branch to Remote

Immediately push to trigger workflow status update:

```bash
git push -u origin feature/{{formats.issueExample}}-brief-description
```

**Why:** The GitHub Actions workflow automatically updates issue status to "{{linear.statuses.inProgress}}" when commits are pushed to feature branches.

---

### When Continuing Work on an Existing Issue

**IMPORTANT:** When resuming work on an issue with an existing branch, you MUST follow these steps:

#### 1. Fetch Issue Context

Use `get_issue` to refresh context:

- Current status and recent updates
- New comments or changes
- Any updated requirements

#### 2. Find and Checkout Existing Branch

Look for the branch associated with the issue:

```bash
# Fetch all remote branches
git fetch --all

# Find branch with issue ID
git branch -a | grep -i "{{formats.issueExample}}"

# Checkout the branch
git checkout feature/{{formats.issueExample}}-brief-description

# Pull latest changes
git pull origin feature/{{formats.issueExample}}-brief-description
```

#### 3. Review Existing Work

- Check git log to see previous commits
- Review task analysis in `{{paths.issues}}{{formats.issueExample}}-brief-description/task-analysis.md`
- Review task analysis comment on Linear issue
- **Check for new feedback comments**
- Check current file changes with `git status` and `git diff`

#### 4. Continue Implementation

- Resume work based on task analysis and acceptance criteria
- Update Linear issue with progress comments as needed
- Commit changes incrementally with descriptive messages

---

### When Creating a Pull Request

1. **Create PR** with issue ID in title (e.g., "{{formats.issueExample}}: Feature description")
2. **Add PR summary comment** to Linear issue using `create_comment`
3. **Status updates automatically** via GitHub Actions workflow

**PR Summary Comment Format:**

```markdown
## Pull Request Created

**PR:** [PR URL]

**Changes:**

- [Key change 1]
- [Key change 2]
- [Key change 3]

**Testing:**

- [Test 1 completed]
- [Test 2 completed]

**Status:** ğŸŸ  In Review

---

**Notes:** [Any additional context for reviewers, or "None"]
```

---

## Git Commit & Pull Request Format

### Commit Message Format

**Structure:**
```
<type>: <description> ({{formats.issueExample}})

Optional detailed description of changes...

Related: {{formats.issueExample}}

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

**Examples:**
```bash
feat: Add live viewer count to studio dashboard ({{formats.issueExample}})

fix: Resolve token refresh race conditions ({{formats.issueExample}})

docs: Update linear-workflow.md for new status behavior ({{formats.issueExample}})
```

### PR Title Format

**Format:**
```
{{formats.issueExample}}: Description of changes
```

**Examples:**
```
{{formats.issueExample}}: Add Linear MCP integration
{{formats.issueExample}}: Fix token refresh race conditions
{{formats.issueExample}}: Implement GitHub workflow automation
```

---

## Linear GitHub Integration Behavior

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EVENT                          â”‚ LINEAR STATUS CHANGE        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Commit to feature branch       â”‚ â†’ "{{linear.statuses.inProgress}}" *          â”‚{{#branches.staging}}
â”‚ PR merged to {{branches.staging}}              â”‚ â†’ "{{linear.statuses.staging}}"        â”‚{{/branches.staging}}
â”‚ PR merged to {{branches.main}}                 â”‚ â†’ "{{linear.statuses.review}}"         â”‚{{#branches.prod}}
â”‚ PR merged to {{branches.prod}}                 â”‚ â†’ "{{linear.statuses.done}}"           â”‚{{/branches.prod}}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

* Only updates to "{{linear.statuses.inProgress}}" if current status is different
  (prevents unnecessary status ping-pong)

Configured in: .github/workflows/linear-status-update.yml
```

---

## MCP Tools Available

Linear MCP server provides these tools:

### Issue Management

- `search_issues` - Search for issues
- `get_issue` - Get detailed issue info
- `list_comments` - List comments on an issue
- `create_issue` - Create new issue
- `update_issue` - Update issue fields
- `create_comment` - Add comment to issue

### Team & Project Management

- `list_teams` - List all teams
- `get_team_workflow_states` - Get team statuses

---

## Quick Reference Card

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     LINEAR WORKFLOW CHEAT SHEET                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ START NEW ISSUE                                                 â•‘
â•‘ 1. git checkout {{branches.main}} && git pull origin {{branches.main}}                   â•‘
â•‘ 2. get_issue(id) + list_comments(id)                          â•‘
â•‘ 3. Create {{paths.issues}}{{formats.issueExample}}-brief-desc/ folder        â•‘
â•‘ 4. Reformat issue (11-section) â†’ task-analysis.md             â•‘
â•‘ 5. Write deep analysis in same file                           â•‘
â•‘ 6. create_comment(id, "## Task Analysis Complete")            â•‘
â•‘ 7. git checkout -b feature/{{formats.issueExample}}-brief-desc                 â•‘
â•‘ 8. git commit --allow-empty -m "chore: Initialize..."         â•‘
â•‘ 9. git push -u origin feature/{{formats.issueExample}}-brief-desc              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ CONTINUE EXISTING ISSUE                                         â•‘
â•‘ 1. get_issue(id) + list_comments(id)                          â•‘
â•‘ 2. git fetch --all && git branch -a | grep {{formats.issueExample}}           â•‘
â•‘ 3. git checkout feature/{{formats.issueExample}}-description                   â•‘
â•‘ 4. git pull origin feature/{{formats.issueExample}}-description                â•‘
â•‘ 5. Review task analysis + feedback                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ CREATE PULL REQUEST                                             â•‘
â•‘ 1. gh pr create --title "{{formats.issueExample}}: Description" --body "..."  â•‘
â•‘ 2. create_comment(id, "## Pull Request Created")              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ COMMIT FORMAT                                                   â•‘
â•‘ <type>: <description> ({{formats.issueExample}})                               â•‘
â•‘                                                                 â•‘
â•‘ Related: {{formats.issueExample}}                                               â•‘
â•‘                                                                 â•‘
â•‘ ğŸ¤– Generated with [Claude Code]                                â•‘
â•‘ Co-Authored-By: Claude <noreply@anthropic.com>                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ STATUS INDICATORS                                               â•‘
â•‘ ğŸŸ¢ Ready  ğŸŸ  Awaiting/In Progress  ğŸ”´ Blocked                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Advanced Commands

Beyond the core workflow, Claude Code supports additional commands for common development scenarios:

### Related Issue Creation

**Create a Blocker:**
```
"Create a blocker for this"
"This is blocked by [description]"
```
Creates a blocking issue, links it to your current work, and marks current issue as blocked.

**Create a Sub-task:**
```
"Create a sub-task for [description]"
"Break this into a sub-task: [description]"
```
Creates a child issue linked to the current issue. Useful for breaking down large features.

**Found a Bug:**
```
"Found a bug: [description]"
"This needs a bug report"
```
Creates a bug report issue. Claude will ask if the bug is related to your current work, part of another issue, or standalone. Links appropriately and sets priority based on severity.

**Create Follow-up:**
```
"Create follow-up for [description]"
"Log this for later: [description]"
```
Creates a backlog issue for improvements or tech debt discovered during current work.

### Progress & Communication

**Progress Update:**
```
"Add progress update"
"Post progress to Linear"
```
Analyzes recent commits and current changes, posts structured update to Linear issue.

**Mark as Blocked:**
```
"Mark as blocked"
"This is blocked by [reason]"
```
Updates issue status to "On Hold", posts blocker comment, optionally creates blocker issue.

**Request Clarification:**
```
"Request clarification on [topic]"
"Need clarification: [question]"
```
Posts formatted question to Linear, tags relevant people, marks as needing clarification.

### Context Switching

**Pause Work:**
```
"Pause work on this"
"Save progress and switch"
```
Commits WIP changes, posts pause comment to Linear, returns to main branch.

**Resume Work:**
```
"Resume DEV-XXX"
"Continue DEV-XXX"
```
Fetches latest issue context, checks out branch, shows what changed since last work.

**What Am I Working On:**
```
"What am I working on?"
"Show my active issues"
```
Lists all your issues in "In Progress" status with their branches and last activity.

### Quick Actions

**Ready for Review:**
```
"Ready for review"
"This is ready"
```
Commits pending changes, creates PR, posts summary to Linear, updates status.

**Address Review Comments:**
```
"Address review comments"
"Fix PR feedback"
```
Fetches PR review comments, creates checklist, works through feedback systematically.

---

## Best Practices

- **Always check parent issues** - Understanding the larger context prevents scope creep
- **Review blockers first** - Don't start work if blocked by another issue
- **Use priority levels** - Urgent (1) and High (2) issues should be addressed first
- **Reference related issues** - Include links to related issues in Task Analysis
- **Keep Linear updated** - Add comments as work progresses, not just at start/end
- **Use full markdown** - Linear comments support full Markdown syntax for better readability

---

**Generated by:** claude-linear-gh-starter
**Configuration:** .linear-workflow.json
