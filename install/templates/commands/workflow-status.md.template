Check the health and status of your Linear workflow integration.

## Usage

```
/workflow-status
/workflow-status --detailed
```

## Description

This command runs a comprehensive health check of all workflow components and provides actionable insights. Perfect for troubleshooting issues or verifying everything is working correctly.

Use this when:
- Something isn't working as expected
- After setup to verify installation
- Before starting work to ensure everything is ready
- When onboarding new team members

## What Gets Checked

### 1. Linear MCP Connection
- âœ… Server configured and accessible
- âœ… Authentication working (OAuth)
- âœ… Can fetch issues from your workspace
- âœ… Can create comments and update issues

### 2. GitHub CLI
- âœ… Installed and accessible
- âœ… Authenticated with correct scopes
- âœ… Repository access confirmed
- âœ… Can create PRs and manage issues

### 3. Git Configuration
- âœ… Repository initialized
- âœ… Remote configured correctly
- âœ… Commit hooks installed
- âœ… Hook validation working

### 4. Workflow Configuration
- âœ… `.linear-workflow.json` exists and valid
- âœ… Team configuration correct
- âœ… Status mappings configured
- âœ… Branch strategy set up

### 5. GitHub Actions (if enabled)
- âœ… Workflow file installed
- âœ… LINEAR_API_KEY secret configured
- âœ… Recent runs successful
- âš ï¸  Failed runs detected

### 6. Recent Activity
- Issues started in last 7 days
- PRs created
- Commits with Linear references
- Status updates

## Output Example

### Healthy System

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Workflow Health Check
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” Checking Linear Integration...

âœ… Linear MCP Connection
   â€¢ Server: Connected
   â€¢ Authentication: Valid (OAuth)
   â€¢ Workspace: {{linear.workspaceName}}
   â€¢ Team: {{linear.teamName}} ({{linear.teamKey}})
   â€¢ Last tested: 2 seconds ago

âœ… GitHub CLI
   â€¢ Version: gh 2.40.0
   â€¢ Authenticated: {{user}}
   â€¢ Scopes: repo, workflow âœ“
   â€¢ Repository: {{owner}}/{{repo}}

âœ… Git Hooks
   â€¢ Location: .git/hooks/commit-msg
   â€¢ Executable: Yes
   â€¢ Tests passing: 7/7 âœ“
   â€¢ Last validation: 1 day ago

âœ… Configuration
   â€¢ File: .linear-workflow.json
   â€¢ Version: 1.0.0
   â€¢ Valid: Yes âœ“
   â€¢ Last updated: 3 days ago

âœ… GitHub Actions
   â€¢ Workflow: linear-status-update.yml
   â€¢ Status: Enabled
   â€¢ Recent runs: 12 successful (7 days)
   â€¢ Last run: 2 hours ago âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Recent Activity (Last 7 Days)

Issues:
  â€¢ Started: 12
  â€¢ Completed: 9 (75%)
  â€¢ In Progress: 3

Pull Requests:
  â€¢ Created: 10
  â€¢ Merged: 8 (80%)
  â€¢ Open: 2

Commits:
  â€¢ Total: 45
  â€¢ With issue refs: 44 (98%)
  â€¢ Hook validated: 100%

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Overall Health: Excellent (100%)

All systems operational! Your workflow is running smoothly.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### System with Issues

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Workflow Health Check
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” Checking Linear Integration...

âŒ Linear MCP Connection
   â€¢ Server: Not responding
   â€¢ Error: Connection timeout

   ğŸ”§ How to fix:
   1. Restart Claude Code to reload MCP config
   2. If still failing, re-authenticate:
      claude mcp remove linear-server
      claude mcp add --transport http linear-server https://mcp.linear.app/mcp
   3. Run /mcp to authenticate

   Need help? See: docs/troubleshooting.md#mcp-connection

âœ… GitHub CLI
   â€¢ Version: gh 2.40.0
   â€¢ Authenticated: {{user}}
   â€¢ Scopes: repo, workflow âœ“

âš ï¸  Git Hooks
   â€¢ Location: .git/hooks/commit-msg
   â€¢ Executable: No âœ—

   ğŸ”§ How to fix:
   chmod +x .git/hooks/commit-msg

   Test the hook:
   node scripts/test-git-hook.js

âœ… Configuration
   â€¢ File: .linear-workflow.json
   â€¢ Valid: Yes âœ“

âš ï¸  GitHub Actions
   â€¢ Workflow: linear-status-update.yml
   â€¢ Status: Enabled
   â€¢ Recent runs: 3 failed, 2 successful (7 days)
   â€¢ Last failure: 1 hour ago

   ğŸ”§ Recent errors:
   â€¢ "LINEAR_API_KEY not found" (2 occurrences)
   â€¢ "Invalid API key" (1 occurrence)

   How to fix:
   1. Verify LINEAR_API_KEY in GitHub secrets
   2. Check API key is valid: https://linear.app/settings/api
   3. Update secret: gh secret set LINEAR_API_KEY

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Recent Activity (Last 7 Days)

Issues:
  â€¢ Started: 5
  â€¢ Completed: 3 (60%)
  â€¢ In Progress: 2

Potential Issues Detected:
  âš ï¸  Branch 'feature/DEV-456' is 3 days old with no commits
      â†’ Consider: /pause-linear or /cleanup-branches

  âš ï¸  Issue DEV-123 in "Feedback Required" for 5 days
      â†’ Consider: /get-feedback-linear or /blocked-linear

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸  Overall Health: Good (75%)

3 issues detected. Follow the fixes above to get to 100%.

Quick fixes available:
  â€¢ Fix git hook: chmod +x .git/hooks/commit-msg
  â€¢ Fix MCP connection: Restart Claude Code
  â€¢ Fix GitHub Actions: Update LINEAR_API_KEY secret

Run these fixes automatically? (Y/n)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

## Detailed Mode

```
/workflow-status --detailed
```

Shows additional information:
- MCP server response times
- GitHub API rate limits
- Disk space for issue analysis docs
- Git repository statistics
- Team member activity breakdown
- Command usage statistics (if analytics enabled)

## Auto-Fix Mode

When issues are detected, Claude can automatically fix common problems:

```
Run these fixes automatically? (Y/n)

You: y

Applying fixes...

1/3 Making git hook executable...
    âœ“ chmod +x .git/hooks/commit-msg
    âœ“ Verified hook is now executable

2/3 Testing MCP connection...
    âœ“ MCP server responding
    âœ“ Linear workspace accessible

3/3 Verifying GitHub Actions secret...
    âš ï¸  Cannot verify secret remotely
    â„¹ï¸  Manual check required

Results:
  âœ“ 2 fixes applied automatically
  âš ï¸ 1 requires manual action

Run health check again? (Y/n)
```

## When to Run

### Recommended Times

**After initial setup:**
```
Just installed? Verify everything works:
/workflow-status
```

**When something breaks:**
```
Issue not updating in Linear? Check what's wrong:
/workflow-status
```

**Before starting work:**
```
Morning checklist:
/workflow-status
```

**After configuration changes:**
```
Updated .linear-workflow.json? Verify:
/workflow-status
```

**When onboarding teammates:**
```
New team member setup:
/workflow-status
```

## Troubleshooting Tips

### MCP Connection Failures

**Symptom:** "Linear MCP Connection: âŒ"

**Common causes:**
1. MCP server not authenticated â†’ Run `/mcp` to authenticate
2. Claude Code not restarted after config change â†’ Restart Claude Code
3. Network issues â†’ Check internet connection

**Quick fix:**
```bash
claude mcp remove linear-server
claude mcp add --transport http linear-server https://mcp.linear.app/mcp
```

Then restart Claude Code and run `/mcp`

### Git Hook Not Working

**Symptom:** "Git Hooks: âš ï¸ Not executable"

**Fix:**
```bash
chmod +x .git/hooks/commit-msg
```

**Test:**
```bash
node scripts/test-git-hook.js
```

### GitHub Actions Failing

**Symptom:** "GitHub Actions: âš ï¸ Recent runs failed"

**Common causes:**
1. LINEAR_API_KEY missing or invalid
2. Workflow file syntax error
3. Branch protection blocking workflow

**Fix:**
```bash
# Verify secret exists
gh secret list

# Update secret
gh secret set LINEAR_API_KEY

# Test workflow
gh workflow run linear-status-update.yml
```

## Configuration

This command uses your existing workflow configuration. No additional setup needed.

Checks are performed in this order:
1. Critical systems (Linear MCP, GitHub CLI)
2. Configuration files
3. Optional features (GitHub Actions)
4. Activity analysis

## Related Commands

- `/linear-help` - Show all available commands
- `/cleanup-branches` - Clean up old branches
- `/workflow-analytics` - View detailed metrics (if enabled)

## Tips

1. **Run regularly** - Add to your morning routine
2. **Share with team** - Great for onboarding
3. **Before reporting issues** - Run this first to diagnose
4. **After updates** - Verify after upgrading workflow version

## Health Score Calculation

The health score is calculated from:
- Critical systems: 40% weight
  - Linear MCP: 15%
  - GitHub CLI: 15%
  - Git hooks: 10%
- Configuration: 20% weight
- GitHub Actions: 20% weight (if enabled)
- Recent activity: 20% weight

100% = All systems operational
75-99% = Good (minor issues)
50-74% = Fair (attention needed)
<50% = Poor (immediate action required)

---

Generated with [Claude Code](https://claude.com/claude-code)
